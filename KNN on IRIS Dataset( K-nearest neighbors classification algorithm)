# loading libraries
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn import metrics

# loading dataset
df1 = pd.read_csv("Iris.csv")

# storing all Feature variables in x 
# storing Target variable in y 
x = df1.iloc[:,0:4]
y = pd.get_dummies(df1["Species"],drop_first=True)

from sklearn.neighbors import KNeighborsClassifier

# split into train and test
x_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.3,random_state=255)

# instantiate learning model (k = 3)
knn = KNeighborsClassifier(n_neighbors=3)     

# fitting model with data, so that it can learn the realtionship between x and y
knn.fit(x_train,y_train)

# predicting new observation 
prediction = knn.predict(x_test)

# evaluating accuracy
print(metrics.accuracy_score(y_test,prediction))

# at k = 5, accuracy = 0.9111
#  at k = 3, accuracy = 0.888
# use random_state = 255 for better accuracy

